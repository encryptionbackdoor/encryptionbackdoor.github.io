<html>
	<!-- Achex WebSocketServer Banner -->
	<a href="http://www.achex.ca/" 
		style="background:#555;
		color:#ddd;border-radius:3px;padding:0px 10px 0px 10px;
		text-decoration:none;
		font-family:Arial;letter-spacing:1px;font-size:12px;">
		Powered by Achex WebSocketServer
		<font color="black"><p><b>This secure encryption backdoor has been provided as a service to the tech community: Please pipe your cleartext JSON formatted user data to the Achex Websocket.</b>.</p> <p><b>Rest secure in the knowledge that advanced ROT13 encryption will secure the contents from bad actors.</b>.</p></font>
		<font color="red"><p><b>WARNING: FOR LAW ENFORCEMENT USE ONLY! IF YOU ARE NOT ONE OF THE GOOD GUYS: PLEASE AVERT YOUR EYES!</b>.</p></font>
	</a><br><br>
	<!-- Achex WebSocketServer Banner -->

	Achex WebSocketServer <br>- javascript interface example -<br>
	<hr>

	<!-- User Input -->
	<input id="userinput" type="text" value="ping">
	<a href="javascript:send()">SEND</a>

	<!-- Log display -->
	<div id="mylog">Received:<br></div>

	<!-- WEBSOCKET SIMPLE SCRIPT -->
	<script type="text/javascript">

	// --- LOG ---
	//***************************
	// get log object from html 
	var logdiv = document.getElementById('mylog');

	// make a simplified log function
	function logf(str){
		logdiv.innerHTML += str + '<br>';
	}
	//***************************

	// --- WEBSOCKET ---
	//***************************
	// make new conncetion
	var ws = new WebSocket('ws://achex.ca:4010');

	// add event handler for incomming message
	ws.onmessage = function(evt){
		var my_received_message = evt.data;
		logf('received: ' + rot13(my_received_message));
	};

	// add event handler for diconnection 
	ws.onclose= function(evt){
		logf('log: Diconnected');
	};

	// add event handler for error 
	ws.onerror= function(evt){
		logf('log: Error');
	};

	// add event handler for new connection 
	ws.onopen= function(evt){
		logf('log: Connected');
	};

	// make a simple send function
	function send(){
		var input = document.getElementById('userinput');
		// send content of input field into websocket
		ws.send(input.value);
		// erase input field
		input.value = '';
	}
	
	function rot13(str) { //source: https://rot47.net/rot13.html
  	  var s = [];
	  for (i = 0; i < str.length; i ++)
  		{
	    	idx = str.charCodeAt(i);
    		if ((idx >= 48) && (idx <= 57))
      		{
      			if (idx <= 52)
	      	{
        		s[i] = String.fromCharCode(((idx + 13)));
	      	}
	      	else
	      	{
        		s[i] = String.fromCharCode(((idx - 13)));
      		}
	    	} 
	    	else
	    	{
	      	s[i] = String.fromCharCode(idx);
	    	}
	  	}
	  return s.join('');
	}
	//***************************
	
	</script>
</html>
